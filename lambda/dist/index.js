"use strict";var Er=Object.create;var L=Object.defineProperty;var vr=Object.getOwnPropertyDescriptor;var wr=Object.getOwnPropertyNames;var Ar=Object.getPrototypeOf,Sr=Object.prototype.hasOwnProperty;var E=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),Rr=(e,t)=>{for(var s in t)L(e,s,{get:t[s],enumerable:!0})},Le=(e,t,s,c)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of wr(t))!Sr.call(e,i)&&i!==s&&L(e,i,{get:()=>t[i],enumerable:!(c=vr(t,i))||c.enumerable});return e};var ae=(e,t,s)=>(s=e!=null?Er(Ar(e)):{},Le(t||!e||!e.__esModule?L(s,"default",{value:e,enumerable:!0}):s,e)),Or=e=>Le(L({},"__esModule",{value:!0}),e);var ie=E(m=>{"use strict";m.HttpAuthLocation=void 0;(function(e){e.HEADER="header",e.QUERY="query"})(m.HttpAuthLocation||(m.HttpAuthLocation={}));m.HttpApiKeyAuthLocation=void 0;(function(e){e.HEADER="header",e.QUERY="query"})(m.HttpApiKeyAuthLocation||(m.HttpApiKeyAuthLocation={}));m.EndpointURLScheme=void 0;(function(e){e.HTTP="http",e.HTTPS="https"})(m.EndpointURLScheme||(m.EndpointURLScheme={}));m.AlgorithmId=void 0;(function(e){e.MD5="md5",e.CRC32="crc32",e.CRC32C="crc32c",e.SHA1="sha1",e.SHA256="sha256"})(m.AlgorithmId||(m.AlgorithmId={}));var Tr=e=>{let t=[];return e.sha256!==void 0&&t.push({algorithmId:()=>m.AlgorithmId.SHA256,checksumConstructor:()=>e.sha256}),e.md5!=null&&t.push({algorithmId:()=>m.AlgorithmId.MD5,checksumConstructor:()=>e.md5}),{addChecksumAlgorithm(s){t.push(s)},checksumAlgorithms(){return t}}},Pr=e=>{let t={};return e.checksumAlgorithms().forEach(s=>{t[s.algorithmId()]=s.checksumConstructor()}),t},Hr=e=>Tr(e),Dr=e=>Pr(e);m.FieldPosition=void 0;(function(e){e[e.HEADER=0]="HEADER",e[e.TRAILER=1]="TRAILER"})(m.FieldPosition||(m.FieldPosition={}));var Ur="__smithy_context";m.IniSectionType=void 0;(function(e){e.PROFILE="profile",e.SSO_SESSION="sso-session",e.SERVICES="services"})(m.IniSectionType||(m.IniSectionType={}));m.RequestHandlerProtocol=void 0;(function(e){e.HTTP_0_9="http/0.9",e.HTTP_1_0="http/1.0",e.TDS_8_0="tds/8.0"})(m.RequestHandlerProtocol||(m.RequestHandlerProtocol={}));m.SMITHY_CONTEXT_KEY=Ur;m.getDefaultClientConfiguration=Hr;m.resolveDefaultRuntimeConfig=Dr});var le=E(P=>{"use strict";var Cr=ie(),Ir=e=>({setHttpHandler(t){e.httpHandler=t},httpHandler(){return e.httpHandler},updateHttpClientConfig(t,s){e.httpHandler?.updateHttpClientConfig(t,s)},httpHandlerConfigs(){return e.httpHandler.httpHandlerConfigs()}}),xr=e=>({httpHandler:e.httpHandler()}),ce=class{name;kind;values;constructor({name:t,kind:s=Cr.FieldPosition.HEADER,values:c=[]}){this.name=t,this.kind=s,this.values=c}add(t){this.values.push(t)}set(t){this.values=t}remove(t){this.values=this.values.filter(s=>s!==t)}toString(){return this.values.map(t=>t.includes(",")||t.includes(" ")?`"${t}"`:t).join(", ")}get(){return this.values}},fe=class{entries={};encoding;constructor({fields:t=[],encoding:s="utf-8"}){t.forEach(this.setField.bind(this)),this.encoding=s}setField(t){this.entries[t.name.toLowerCase()]=t}getField(t){return this.entries[t.toLowerCase()]}removeField(t){delete this.entries[t.toLowerCase()]}getByType(t){return Object.values(this.entries).filter(s=>s.kind===t)}},C=class{method;protocol;hostname;port;path;query;headers;username;password;fragment;body;constructor(t){this.method=t.method||"GET",this.hostname=t.hostname||"localhost",this.port=t.port,this.query=t.query||{},this.headers=t.headers||{},this.body=t.body,this.protocol=t.protocol?t.protocol.slice(-1)!==":"?`${t.protocol}:`:t.protocol:"https:",this.path=t.path?t.path.charAt(0)!=="/"?`/${t.path}`:t.path:"/",this.username=t.username,this.password=t.password,this.fragment=t.fragment}static clone(t){let s=new C({...t,headers:{...t.headers}});return s.query&&(s.query=jr(s.query)),s}static isInstance(t){if(!t)return!1;let s=t;return"method"in s&&"protocol"in s&&"hostname"in s&&"path"in s&&typeof s.query=="object"&&typeof s.headers=="object"}clone(){return C.clone(this)}};function jr(e){return Object.keys(e).reduce((t,s)=>{let c=e[s];return{...t,[s]:Array.isArray(c)?[...c]:c}},{})}var ue=class{statusCode;reason;headers;body;constructor(t){this.statusCode=t.statusCode,this.reason=t.reason,this.headers=t.headers||{},this.body=t.body}static isInstance(t){if(!t)return!1;let s=t;return typeof s.statusCode=="number"&&typeof s.headers=="object"}};function Lr(e){return/^[a-z0-9][a-z0-9\.\-]*[a-z0-9]$/.test(e)}P.Field=ce;P.Fields=fe;P.HttpRequest=C;P.HttpResponse=ue;P.getHttpHandlerExtensionConfiguration=Ir;P.isValidHostname=Lr;P.resolveHttpHandlerRuntimeConfig=xr});var Ne=E(ye=>{"use strict";var Be={},he={};for(let e=0;e<256;e++){let t=e.toString(16).toLowerCase();t.length===1&&(t=`0${t}`),Be[e]=t,he[t]=e}function Br(e){if(e.length%2!==0)throw new Error("Hex encoded strings must have an even number length");let t=new Uint8Array(e.length/2);for(let s=0;s<e.length;s+=2){let c=e.slice(s,s+2).toLowerCase();if(c in he)t[s/2]=he[c];else throw new Error(`Cannot decode unrecognized sequence ${c} as hexadecimal`)}return t}function Nr(e){let t="";for(let s=0;s<e.byteLength;s++)t+=Be[e[s]];return t}ye.fromHex=Br;ye.toHex=Nr});var _e=E(Me=>{"use strict";var Mr=e=>typeof ArrayBuffer=="function"&&e instanceof ArrayBuffer||Object.prototype.toString.call(e)==="[object ArrayBuffer]";Me.isArrayBuffer=Mr});var $e=E(pe=>{"use strict";var $r=_e(),de=require("buffer"),qr=(e,t=0,s=e.byteLength-t)=>{if(!$r.isArrayBuffer(e))throw new TypeError(`The "input" argument must be ArrayBuffer. Received type ${typeof e} (${e})`);return de.Buffer.from(e,t,s)},Fr=(e,t)=>{if(typeof e!="string")throw new TypeError(`The "input" argument must be of type string. Received type ${typeof e} (${e})`);return t?de.Buffer.from(e,t):de.Buffer.from(e)};pe.fromArrayBuffer=qr;pe.fromString=Fr});var Ke=E(B=>{"use strict";var qe=$e(),Fe=e=>{let t=qe.fromString(e,"utf8");return new Uint8Array(t.buffer,t.byteOffset,t.byteLength/Uint8Array.BYTES_PER_ELEMENT)},Kr=e=>typeof e=="string"?Fe(e):ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(e),Gr=e=>{if(typeof e=="string")return e;if(typeof e!="object"||typeof e.byteOffset!="number"||typeof e.byteLength!="number")throw new Error("@smithy/util-utf8: toUtf8 encoder function only accepts string | Uint8Array.");return qe.fromArrayBuffer(e.buffer,e.byteOffset,e.byteLength).toString("utf8")};B.fromUtf8=Fe;B.toUint8Array=Kr;B.toUtf8=Gr});var Ye=E(ge=>{"use strict";var Ge=ie(),Yr=e=>e[Ge.SMITHY_CONTEXT_KEY]||(e[Ge.SMITHY_CONTEXT_KEY]={}),kr=e=>{if(typeof e=="function")return e;let t=Promise.resolve(e);return()=>t};ge.getSmithyContext=Yr;ge.normalizeProvider=kr});var Ve=E(me=>{"use strict";var ke=e=>encodeURIComponent(e).replace(/[!'()*]/g,Vr),Vr=e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`,zr=e=>e.split("/").map(ke).join("/");me.escapeUri=ke;me.escapeUriPath=zr});var gt=E(_=>{"use strict";var H=Ne(),U=Ke(),Xr=_e(),Ze=le(),ze=Ye(),N=Ve(),We="X-Amz-Algorithm",Je="X-Amz-Credential",Ae="X-Amz-Date",et="X-Amz-SignedHeaders",tt="X-Amz-Expires",Se="X-Amz-Signature",Re="X-Amz-Security-Token",Qr="X-Amz-Region-Set",Oe="authorization",Te=Ae.toLowerCase(),rt="date",nt=[Oe,Te,rt],st=Se.toLowerCase(),K="x-amz-content-sha256",ot=Re.toLowerCase(),Zr="host",at={authorization:!0,"cache-control":!0,connection:!0,expect:!0,from:!0,"keep-alive":!0,"max-forwards":!0,pragma:!0,referer:!0,te:!0,trailer:!0,"transfer-encoding":!0,upgrade:!0,"user-agent":!0,"x-amzn-trace-id":!0},it=/^proxy-/,ct=/^sec-/,Wr=[/^proxy-/i,/^sec-/i],M="AWS4-HMAC-SHA256",Jr="AWS4-ECDSA-P256-SHA256",ft="AWS4-HMAC-SHA256-PAYLOAD",ut="UNSIGNED-PAYLOAD",lt=50,Pe="aws4_request",ht=60*60*24*7,I={},$=[],q=(e,t,s)=>`${e}/${t}/${s}/${Pe}`,yt=async(e,t,s,c,i)=>{let r=await Xe(e,t.secretAccessKey,t.accessKeyId),n=`${s}:${c}:${i}:${H.toHex(r)}:${t.sessionToken}`;if(n in I)return I[n];for($.push(n);$.length>lt;)delete I[$.shift()];let o=`AWS4${t.secretAccessKey}`;for(let a of[s,c,i,Pe])o=await Xe(e,o,a);return I[n]=o},en=()=>{$.length=0,Object.keys(I).forEach(e=>{delete I[e]})},Xe=(e,t,s)=>{let c=new e(t);return c.update(U.toUint8Array(s)),c.digest()},be=({headers:e},t,s)=>{let c={};for(let i of Object.keys(e).sort()){if(e[i]==null)continue;let r=i.toLowerCase();(r in at||t?.has(r)||it.test(r)||ct.test(r))&&(!s||s&&!s.has(r))||(c[r]=e[i].trim().replace(/\s+/g," "))}return c},F=async({headers:e,body:t},s)=>{for(let c of Object.keys(e))if(c.toLowerCase()===K)return e[c];if(t==null)return"e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855";if(typeof t=="string"||ArrayBuffer.isView(t)||Xr.isArrayBuffer(t)){let c=new s;return c.update(U.toUint8Array(t)),H.toHex(await c.digest())}return ut},Ee=class{format(t){let s=[];for(let r of Object.keys(t)){let n=U.fromUtf8(r);s.push(Uint8Array.from([n.byteLength]),n,this.formatHeaderValue(t[r]))}let c=new Uint8Array(s.reduce((r,n)=>r+n.byteLength,0)),i=0;for(let r of s)c.set(r,i),i+=r.byteLength;return c}formatHeaderValue(t){switch(t.type){case"boolean":return Uint8Array.from([t.value?0:1]);case"byte":return Uint8Array.from([2,t.value]);case"short":let s=new DataView(new ArrayBuffer(3));return s.setUint8(0,3),s.setInt16(1,t.value,!1),new Uint8Array(s.buffer);case"integer":let c=new DataView(new ArrayBuffer(5));return c.setUint8(0,4),c.setInt32(1,t.value,!1),new Uint8Array(c.buffer);case"long":let i=new Uint8Array(9);return i[0]=5,i.set(t.value.bytes,1),i;case"binary":let r=new DataView(new ArrayBuffer(3+t.value.byteLength));r.setUint8(0,6),r.setUint16(1,t.value.byteLength,!1);let n=new Uint8Array(r.buffer);return n.set(t.value,3),n;case"string":let o=U.fromUtf8(t.value),a=new DataView(new ArrayBuffer(3+o.byteLength));a.setUint8(0,7),a.setUint16(1,o.byteLength,!1);let f=new Uint8Array(a.buffer);return f.set(o,3),f;case"timestamp":let u=new Uint8Array(9);return u[0]=8,u.set(j.fromNumber(t.value.valueOf()).bytes,1),u;case"uuid":if(!tn.test(t.value))throw new Error(`Invalid UUID received: ${t.value}`);let l=new Uint8Array(17);return l[0]=9,l.set(H.fromHex(t.value.replace(/\-/g,"")),1),l}}},tn=/^[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}$/,j=class{bytes;constructor(t){if(this.bytes=t,t.byteLength!==8)throw new Error("Int64 buffers must be exactly 8 bytes")}static fromNumber(t){if(t>9223372036854776e3||t<-9223372036854776e3)throw new Error(`${t} is too large (or, if negative, too small) to represent as an Int64`);let s=new Uint8Array(8);for(let c=7,i=Math.abs(Math.round(t));c>-1&&i>0;c--,i/=256)s[c]=i;return t<0&&Qe(s),new j(s)}valueOf(){let t=this.bytes.slice(0),s=t[0]&128;return s&&Qe(t),parseInt(H.toHex(t),16)*(s?-1:1)}toString(){return String(this.valueOf())}};function Qe(e){for(let t=0;t<8;t++)e[t]^=255;for(let t=7;t>-1&&(e[t]++,e[t]===0);t--);}var _t=(e,t)=>{e=e.toLowerCase();for(let s of Object.keys(t))if(e===s.toLowerCase())return!0;return!1},dt=(e,t={})=>{let{headers:s,query:c={}}=Ze.HttpRequest.clone(e);for(let i of Object.keys(s)){let r=i.toLowerCase();(r.slice(0,6)==="x-amz-"&&!t.unhoistableHeaders?.has(r)||t.hoistableHeaders?.has(r))&&(c[i]=s[i],delete s[i])}return{...e,headers:s,query:c}},ve=e=>{e=Ze.HttpRequest.clone(e);for(let t of Object.keys(e.headers))nt.indexOf(t.toLowerCase())>-1&&delete e.headers[t];return e},pt=({query:e={}})=>{let t=[],s={};for(let c of Object.keys(e)){if(c.toLowerCase()===st)continue;let i=N.escapeUri(c);t.push(i);let r=e[c];typeof r=="string"?s[i]=`${i}=${N.escapeUri(r)}`:Array.isArray(r)&&(s[i]=r.slice(0).reduce((n,o)=>n.concat([`${i}=${N.escapeUri(o)}`]),[]).sort().join("&"))}return t.sort().map(c=>s[c]).filter(c=>c).join("&")},rn=e=>nn(e).toISOString().replace(/\.\d{3}Z$/,"Z"),nn=e=>typeof e=="number"?new Date(e*1e3):typeof e=="string"?Number(e)?new Date(Number(e)*1e3):new Date(e):e,G=class{service;regionProvider;credentialProvider;sha256;uriEscapePath;applyChecksum;constructor({applyChecksum:t,credentials:s,region:c,service:i,sha256:r,uriEscapePath:n=!0}){this.service=i,this.sha256=r,this.uriEscapePath=n,this.applyChecksum=typeof t=="boolean"?t:!0,this.regionProvider=ze.normalizeProvider(c),this.credentialProvider=ze.normalizeProvider(s)}createCanonicalRequest(t,s,c){let i=Object.keys(s).sort();return`${t.method}
${this.getCanonicalPath(t)}
${pt(t)}
${i.map(r=>`${r}:${s[r]}`).join(`
`)}

${i.join(";")}
${c}`}async createStringToSign(t,s,c,i){let r=new this.sha256;r.update(U.toUint8Array(c));let n=await r.digest();return`${i}
${t}
${s}
${H.toHex(n)}`}getCanonicalPath({path:t}){if(this.uriEscapePath){let s=[];for(let r of t.split("/"))r?.length!==0&&r!=="."&&(r===".."?s.pop():s.push(r));let c=`${t?.startsWith("/")?"/":""}${s.join("/")}${s.length>0&&t?.endsWith("/")?"/":""}`;return N.escapeUri(c).replace(/%2F/g,"/")}return t}validateResolvedCredentials(t){if(typeof t!="object"||typeof t.accessKeyId!="string"||typeof t.secretAccessKey!="string")throw new Error("Resolved credential object is not valid")}formatDate(t){let s=rn(t).replace(/[\-:]/g,"");return{longDate:s,shortDate:s.slice(0,8)}}getCanonicalHeaderList(t){return Object.keys(t).sort().join(";")}},we=class extends G{headerFormatter=new Ee;constructor({applyChecksum:t,credentials:s,region:c,service:i,sha256:r,uriEscapePath:n=!0}){super({applyChecksum:t,credentials:s,region:c,service:i,sha256:r,uriEscapePath:n})}async presign(t,s={}){let{signingDate:c=new Date,expiresIn:i=3600,unsignableHeaders:r,unhoistableHeaders:n,signableHeaders:o,hoistableHeaders:a,signingRegion:f,signingService:u}=s,l=await this.credentialProvider();this.validateResolvedCredentials(l);let h=f??await this.regionProvider(),{longDate:d,shortDate:y}=this.formatDate(c);if(i>ht)return Promise.reject("Signature version 4 presigned URLs must have an expiration date less than one week in the future");let p=q(y,h,u??this.service),g=dt(ve(t),{unhoistableHeaders:n,hoistableHeaders:a});l.sessionToken&&(g.query[Re]=l.sessionToken),g.query[We]=M,g.query[Je]=`${l.accessKeyId}/${p}`,g.query[Ae]=d,g.query[tt]=i.toString(10);let R=be(g,r,o);return g.query[et]=this.getCanonicalHeaderList(R),g.query[Se]=await this.getSignature(d,p,this.getSigningKey(l,h,y,u),this.createCanonicalRequest(g,R,await F(t,this.sha256))),g}async sign(t,s){return typeof t=="string"?this.signString(t,s):t.headers&&t.payload?this.signEvent(t,s):t.message?this.signMessage(t,s):this.signRequest(t,s)}async signEvent({headers:t,payload:s},{signingDate:c=new Date,priorSignature:i,signingRegion:r,signingService:n}){let o=r??await this.regionProvider(),{shortDate:a,longDate:f}=this.formatDate(c),u=q(a,o,n??this.service),l=await F({headers:{},body:s},this.sha256),h=new this.sha256;h.update(t);let d=H.toHex(await h.digest()),y=[ft,f,u,i,d,l].join(`
`);return this.signString(y,{signingDate:c,signingRegion:o,signingService:n})}async signMessage(t,{signingDate:s=new Date,signingRegion:c,signingService:i}){return this.signEvent({headers:this.headerFormatter.format(t.message.headers),payload:t.message.body},{signingDate:s,signingRegion:c,signingService:i,priorSignature:t.priorSignature}).then(n=>({message:t.message,signature:n}))}async signString(t,{signingDate:s=new Date,signingRegion:c,signingService:i}={}){let r=await this.credentialProvider();this.validateResolvedCredentials(r);let n=c??await this.regionProvider(),{shortDate:o}=this.formatDate(s),a=new this.sha256(await this.getSigningKey(r,n,o,i));return a.update(U.toUint8Array(t)),H.toHex(await a.digest())}async signRequest(t,{signingDate:s=new Date,signableHeaders:c,unsignableHeaders:i,signingRegion:r,signingService:n}={}){let o=await this.credentialProvider();this.validateResolvedCredentials(o);let a=r??await this.regionProvider(),f=ve(t),{longDate:u,shortDate:l}=this.formatDate(s),h=q(l,a,n??this.service);f.headers[Te]=u,o.sessionToken&&(f.headers[ot]=o.sessionToken);let d=await F(f,this.sha256);!_t(K,f.headers)&&this.applyChecksum&&(f.headers[K]=d);let y=be(f,i,c),p=await this.getSignature(u,h,this.getSigningKey(o,a,l,n),this.createCanonicalRequest(f,y,d));return f.headers[Oe]=`${M} Credential=${o.accessKeyId}/${h}, SignedHeaders=${this.getCanonicalHeaderList(y)}, Signature=${p}`,f}async getSignature(t,s,c,i){let r=await this.createStringToSign(t,s,i,M),n=new this.sha256(await c);return n.update(U.toUint8Array(r)),H.toHex(await n.digest())}getSigningKey(t,s,c,i){return yt(this.sha256,t,c,s,i||this.service)}},sn={SignatureV4a:null};_.ALGORITHM_IDENTIFIER=M;_.ALGORITHM_IDENTIFIER_V4A=Jr;_.ALGORITHM_QUERY_PARAM=We;_.ALWAYS_UNSIGNABLE_HEADERS=at;_.AMZ_DATE_HEADER=Te;_.AMZ_DATE_QUERY_PARAM=Ae;_.AUTH_HEADER=Oe;_.CREDENTIAL_QUERY_PARAM=Je;_.DATE_HEADER=rt;_.EVENT_ALGORITHM_IDENTIFIER=ft;_.EXPIRES_QUERY_PARAM=tt;_.GENERATED_HEADERS=nt;_.HOST_HEADER=Zr;_.KEY_TYPE_IDENTIFIER=Pe;_.MAX_CACHE_SIZE=lt;_.MAX_PRESIGNED_TTL=ht;_.PROXY_HEADER_PATTERN=it;_.REGION_SET_PARAM=Qr;_.SEC_HEADER_PATTERN=ct;_.SHA256_HEADER=K;_.SIGNATURE_HEADER=st;_.SIGNATURE_QUERY_PARAM=Se;_.SIGNED_HEADERS_QUERY_PARAM=et;_.SignatureV4=we;_.SignatureV4Base=G;_.TOKEN_HEADER=ot;_.TOKEN_QUERY_PARAM=Re;_.UNSIGNABLE_PATTERNS=Wr;_.UNSIGNED_PAYLOAD=ut;_.clearCredentialCache=en;_.createScope=q;_.getCanonicalHeaders=be;_.getCanonicalQuery=pt;_.getPayloadHash=F;_.getSigningKey=yt;_.hasHeader=_t;_.moveHeadersToQuery=dt;_.prepareRequest=ve;_.signatureV4aContainer=sn});var De=E((as,V)=>{var mt,bt,Et,vt,wt,At,St,Rt,Ot,Tt,Pt,Ht,Dt,Y,He,Ut,Ct,It,x,xt,jt,Lt,Bt,Nt,Mt,$t,qt,Ft,k,Kt,Gt,Yt;(function(e){var t=typeof global=="object"?global:typeof self=="object"?self:typeof this=="object"?this:{};typeof define=="function"&&define.amd?define("tslib",["exports"],function(c){e(s(t,s(c)))}):typeof V=="object"&&typeof V.exports=="object"?e(s(t,s(V.exports))):e(s(t));function s(c,i){return c!==t&&(typeof Object.create=="function"?Object.defineProperty(c,"__esModule",{value:!0}):c.__esModule=!0),function(r,n){return c[r]=i?i(r,n):n}}})(function(e){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])};mt=function(r,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(r,n);function o(){this.constructor=r}r.prototype=n===null?Object.create(n):(o.prototype=n.prototype,new o)},bt=Object.assign||function(r){for(var n,o=1,a=arguments.length;o<a;o++){n=arguments[o];for(var f in n)Object.prototype.hasOwnProperty.call(n,f)&&(r[f]=n[f])}return r},Et=function(r,n){var o={};for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&n.indexOf(a)<0&&(o[a]=r[a]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var f=0,a=Object.getOwnPropertySymbols(r);f<a.length;f++)n.indexOf(a[f])<0&&Object.prototype.propertyIsEnumerable.call(r,a[f])&&(o[a[f]]=r[a[f]]);return o},vt=function(r,n,o,a){var f=arguments.length,u=f<3?n:a===null?a=Object.getOwnPropertyDescriptor(n,o):a,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(r,n,o,a);else for(var h=r.length-1;h>=0;h--)(l=r[h])&&(u=(f<3?l(u):f>3?l(n,o,u):l(n,o))||u);return f>3&&u&&Object.defineProperty(n,o,u),u},wt=function(r,n){return function(o,a){n(o,a,r)}},At=function(r,n,o,a,f,u){function l(D){if(D!==void 0&&typeof D!="function")throw new TypeError("Function expected");return D}for(var h=a.kind,d=h==="getter"?"get":h==="setter"?"set":"value",y=!n&&r?a.static?r:r.prototype:null,p=n||(y?Object.getOwnPropertyDescriptor(y,a.name):{}),g,R=!1,b=o.length-1;b>=0;b--){var v={};for(var S in a)v[S]=S==="access"?{}:a[S];for(var S in a.access)v.access[S]=a.access[S];v.addInitializer=function(D){if(R)throw new TypeError("Cannot add initializers after decoration has completed");u.push(l(D||null))};var T=(0,o[b])(h==="accessor"?{get:p.get,set:p.set}:p[d],v);if(h==="accessor"){if(T===void 0)continue;if(T===null||typeof T!="object")throw new TypeError("Object expected");(g=l(T.get))&&(p.get=g),(g=l(T.set))&&(p.set=g),(g=l(T.init))&&f.unshift(g)}else(g=l(T))&&(h==="field"?f.unshift(g):p[d]=g)}y&&Object.defineProperty(y,a.name,p),R=!0},St=function(r,n,o){for(var a=arguments.length>2,f=0;f<n.length;f++)o=a?n[f].call(r,o):n[f].call(r);return a?o:void 0},Rt=function(r){return typeof r=="symbol"?r:"".concat(r)},Ot=function(r,n,o){return typeof n=="symbol"&&(n=n.description?"[".concat(n.description,"]"):""),Object.defineProperty(r,"name",{configurable:!0,value:o?"".concat(o," ",n):n})},Tt=function(r,n){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,n)},Pt=function(r,n,o,a){function f(u){return u instanceof o?u:new o(function(l){l(u)})}return new(o||(o=Promise))(function(u,l){function h(p){try{y(a.next(p))}catch(g){l(g)}}function d(p){try{y(a.throw(p))}catch(g){l(g)}}function y(p){p.done?u(p.value):f(p.value).then(h,d)}y((a=a.apply(r,n||[])).next())})},Ht=function(r,n){var o={label:0,sent:function(){if(u[0]&1)throw u[1];return u[1]},trys:[],ops:[]},a,f,u,l=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return l.next=h(0),l.throw=h(1),l.return=h(2),typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function h(y){return function(p){return d([y,p])}}function d(y){if(a)throw new TypeError("Generator is already executing.");for(;l&&(l=0,y[0]&&(o=0)),o;)try{if(a=1,f&&(u=y[0]&2?f.return:y[0]?f.throw||((u=f.return)&&u.call(f),0):f.next)&&!(u=u.call(f,y[1])).done)return u;switch(f=0,u&&(y=[y[0]&2,u.value]),y[0]){case 0:case 1:u=y;break;case 4:return o.label++,{value:y[1],done:!1};case 5:o.label++,f=y[1],y=[0];continue;case 7:y=o.ops.pop(),o.trys.pop();continue;default:if(u=o.trys,!(u=u.length>0&&u[u.length-1])&&(y[0]===6||y[0]===2)){o=0;continue}if(y[0]===3&&(!u||y[1]>u[0]&&y[1]<u[3])){o.label=y[1];break}if(y[0]===6&&o.label<u[1]){o.label=u[1],u=y;break}if(u&&o.label<u[2]){o.label=u[2],o.ops.push(y);break}u[2]&&o.ops.pop(),o.trys.pop();continue}y=n.call(r,o)}catch(p){y=[6,p],f=0}finally{a=u=0}if(y[0]&5)throw y[1];return{value:y[0]?y[1]:void 0,done:!0}}},Dt=function(r,n){for(var o in r)o!=="default"&&!Object.prototype.hasOwnProperty.call(n,o)&&k(n,r,o)},k=Object.create?function(r,n,o,a){a===void 0&&(a=o);var f=Object.getOwnPropertyDescriptor(n,o);(!f||("get"in f?!n.__esModule:f.writable||f.configurable))&&(f={enumerable:!0,get:function(){return n[o]}}),Object.defineProperty(r,a,f)}:function(r,n,o,a){a===void 0&&(a=o),r[a]=n[o]},Y=function(r){var n=typeof Symbol=="function"&&Symbol.iterator,o=n&&r[n],a=0;if(o)return o.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&a>=r.length&&(r=void 0),{value:r&&r[a++],done:!r}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")},He=function(r,n){var o=typeof Symbol=="function"&&r[Symbol.iterator];if(!o)return r;var a=o.call(r),f,u=[],l;try{for(;(n===void 0||n-- >0)&&!(f=a.next()).done;)u.push(f.value)}catch(h){l={error:h}}finally{try{f&&!f.done&&(o=a.return)&&o.call(a)}finally{if(l)throw l.error}}return u},Ut=function(){for(var r=[],n=0;n<arguments.length;n++)r=r.concat(He(arguments[n]));return r},Ct=function(){for(var r=0,n=0,o=arguments.length;n<o;n++)r+=arguments[n].length;for(var a=Array(r),f=0,n=0;n<o;n++)for(var u=arguments[n],l=0,h=u.length;l<h;l++,f++)a[f]=u[l];return a},It=function(r,n,o){if(o||arguments.length===2)for(var a=0,f=n.length,u;a<f;a++)(u||!(a in n))&&(u||(u=Array.prototype.slice.call(n,0,a)),u[a]=n[a]);return r.concat(u||Array.prototype.slice.call(n))},x=function(r){return this instanceof x?(this.v=r,this):new x(r)},xt=function(r,n,o){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var a=o.apply(r,n||[]),f,u=[];return f=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),h("next"),h("throw"),h("return",l),f[Symbol.asyncIterator]=function(){return this},f;function l(b){return function(v){return Promise.resolve(v).then(b,g)}}function h(b,v){a[b]&&(f[b]=function(S){return new Promise(function(T,D){u.push([b,S,T,D])>1||d(b,S)})},v&&(f[b]=v(f[b])))}function d(b,v){try{y(a[b](v))}catch(S){R(u[0][3],S)}}function y(b){b.value instanceof x?Promise.resolve(b.value.v).then(p,g):R(u[0][2],b)}function p(b){d("next",b)}function g(b){d("throw",b)}function R(b,v){b(v),u.shift(),u.length&&d(u[0][0],u[0][1])}},jt=function(r){var n,o;return n={},a("next"),a("throw",function(f){throw f}),a("return"),n[Symbol.iterator]=function(){return this},n;function a(f,u){n[f]=r[f]?function(l){return(o=!o)?{value:x(r[f](l)),done:!1}:u?u(l):l}:u}},Lt=function(r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r[Symbol.asyncIterator],o;return n?n.call(r):(r=typeof Y=="function"?Y(r):r[Symbol.iterator](),o={},a("next"),a("throw"),a("return"),o[Symbol.asyncIterator]=function(){return this},o);function a(u){o[u]=r[u]&&function(l){return new Promise(function(h,d){l=r[u](l),f(h,d,l.done,l.value)})}}function f(u,l,h,d){Promise.resolve(d).then(function(y){u({value:y,done:h})},l)}},Bt=function(r,n){return Object.defineProperty?Object.defineProperty(r,"raw",{value:n}):r.raw=n,r};var s=Object.create?function(r,n){Object.defineProperty(r,"default",{enumerable:!0,value:n})}:function(r,n){r.default=n},c=function(r){return c=Object.getOwnPropertyNames||function(n){var o=[];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(o[o.length]=a);return o},c(r)};Nt=function(r){if(r&&r.__esModule)return r;var n={};if(r!=null)for(var o=c(r),a=0;a<o.length;a++)o[a]!=="default"&&k(n,r,o[a]);return s(n,r),n},Mt=function(r){return r&&r.__esModule?r:{default:r}},$t=function(r,n,o,a){if(o==="a"&&!a)throw new TypeError("Private accessor was defined without a getter");if(typeof n=="function"?r!==n||!a:!n.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return o==="m"?a:o==="a"?a.call(r):a?a.value:n.get(r)},qt=function(r,n,o,a,f){if(a==="m")throw new TypeError("Private method is not writable");if(a==="a"&&!f)throw new TypeError("Private accessor was defined without a setter");if(typeof n=="function"?r!==n||!f:!n.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return a==="a"?f.call(r,o):f?f.value=o:n.set(r,o),o},Ft=function(r,n){if(n===null||typeof n!="object"&&typeof n!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof r=="function"?n===r:r.has(n)},Kt=function(r,n,o){if(n!=null){if(typeof n!="object"&&typeof n!="function")throw new TypeError("Object expected.");var a,f;if(o){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");a=n[Symbol.asyncDispose]}if(a===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");a=n[Symbol.dispose],o&&(f=a)}if(typeof a!="function")throw new TypeError("Object not disposable.");f&&(a=function(){try{f.call(this)}catch(u){return Promise.reject(u)}}),r.stack.push({value:n,dispose:a,async:o})}else o&&r.stack.push({async:!0});return n};var i=typeof SuppressedError=="function"?SuppressedError:function(r,n,o){var a=new Error(o);return a.name="SuppressedError",a.error=r,a.suppressed=n,a};Gt=function(r){function n(u){r.error=r.hasError?new i(u,r.error,"An error was suppressed during disposal."):u,r.hasError=!0}var o,a=0;function f(){for(;o=r.stack.pop();)try{if(!o.async&&a===1)return a=0,r.stack.push(o),Promise.resolve().then(f);if(o.dispose){var u=o.dispose.call(o.value);if(o.async)return a|=2,Promise.resolve(u).then(f,function(l){return n(l),f()})}else a|=1}catch(l){n(l)}if(a===1)return r.hasError?Promise.reject(r.error):Promise.resolve();if(r.hasError)throw r.error}return f()},Yt=function(r,n){return typeof r=="string"&&/^\.\.?\//.test(r)?r.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(o,a,f,u,l){return a?n?".jsx":".js":f&&(!u||!l)?o:f+u+"."+l.toLowerCase()+"js"}):r},e("__extends",mt),e("__assign",bt),e("__rest",Et),e("__decorate",vt),e("__param",wt),e("__esDecorate",At),e("__runInitializers",St),e("__propKey",Rt),e("__setFunctionName",Ot),e("__metadata",Tt),e("__awaiter",Pt),e("__generator",Ht),e("__exportStar",Dt),e("__createBinding",k),e("__values",Y),e("__read",He),e("__spread",Ut),e("__spreadArrays",Ct),e("__spreadArray",It),e("__await",x),e("__asyncGenerator",xt),e("__asyncDelegator",jt),e("__asyncValues",Lt),e("__makeTemplateObject",Bt),e("__importStar",Nt),e("__importDefault",Mt),e("__classPrivateFieldGet",$t),e("__classPrivateFieldSet",qt),e("__classPrivateFieldIn",Ft),e("__addDisposableResource",Kt),e("__disposeResources",Gt),e("__rewriteRelativeImportExtension",Yt)})});var Ue=E(w=>{"use strict";Object.defineProperty(w,"__esModule",{value:!0});w.MAX_HASHABLE_LENGTH=w.INIT=w.KEY=w.DIGEST_LENGTH=w.BLOCK_SIZE=void 0;w.BLOCK_SIZE=64;w.DIGEST_LENGTH=32;w.KEY=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);w.INIT=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225];w.MAX_HASHABLE_LENGTH=Math.pow(2,53)-1});var kt=E(z=>{"use strict";Object.defineProperty(z,"__esModule",{value:!0});z.RawSha256=void 0;var A=Ue(),on=function(){function e(){this.state=Int32Array.from(A.INIT),this.temp=new Int32Array(64),this.buffer=new Uint8Array(64),this.bufferLength=0,this.bytesHashed=0,this.finished=!1}return e.prototype.update=function(t){if(this.finished)throw new Error("Attempted to update an already finished hash.");var s=0,c=t.byteLength;if(this.bytesHashed+=c,this.bytesHashed*8>A.MAX_HASHABLE_LENGTH)throw new Error("Cannot hash more than 2^53 - 1 bits");for(;c>0;)this.buffer[this.bufferLength++]=t[s++],c--,this.bufferLength===A.BLOCK_SIZE&&(this.hashBuffer(),this.bufferLength=0)},e.prototype.digest=function(){if(!this.finished){var t=this.bytesHashed*8,s=new DataView(this.buffer.buffer,this.buffer.byteOffset,this.buffer.byteLength),c=this.bufferLength;if(s.setUint8(this.bufferLength++,128),c%A.BLOCK_SIZE>=A.BLOCK_SIZE-8){for(var i=this.bufferLength;i<A.BLOCK_SIZE;i++)s.setUint8(i,0);this.hashBuffer(),this.bufferLength=0}for(var i=this.bufferLength;i<A.BLOCK_SIZE-8;i++)s.setUint8(i,0);s.setUint32(A.BLOCK_SIZE-8,Math.floor(t/4294967296),!0),s.setUint32(A.BLOCK_SIZE-4,t),this.hashBuffer(),this.finished=!0}for(var r=new Uint8Array(A.DIGEST_LENGTH),i=0;i<8;i++)r[i*4]=this.state[i]>>>24&255,r[i*4+1]=this.state[i]>>>16&255,r[i*4+2]=this.state[i]>>>8&255,r[i*4+3]=this.state[i]>>>0&255;return r},e.prototype.hashBuffer=function(){for(var t=this,s=t.buffer,c=t.state,i=c[0],r=c[1],n=c[2],o=c[3],a=c[4],f=c[5],u=c[6],l=c[7],h=0;h<A.BLOCK_SIZE;h++){if(h<16)this.temp[h]=(s[h*4]&255)<<24|(s[h*4+1]&255)<<16|(s[h*4+2]&255)<<8|s[h*4+3]&255;else{var d=this.temp[h-2],y=(d>>>17|d<<15)^(d>>>19|d<<13)^d>>>10;d=this.temp[h-15];var p=(d>>>7|d<<25)^(d>>>18|d<<14)^d>>>3;this.temp[h]=(y+this.temp[h-7]|0)+(p+this.temp[h-16]|0)}var g=(((a>>>6|a<<26)^(a>>>11|a<<21)^(a>>>25|a<<7))+(a&f^~a&u)|0)+(l+(A.KEY[h]+this.temp[h]|0)|0)|0,R=((i>>>2|i<<30)^(i>>>13|i<<19)^(i>>>22|i<<10))+(i&r^i&n^r&n)|0;l=u,u=f,f=a,a=o+g|0,o=n,n=r,r=i,i=g+R|0}c[0]+=i,c[1]+=r,c[2]+=n,c[3]+=o,c[4]+=a,c[5]+=f,c[6]+=u,c[7]+=l},e}();z.RawSha256=on});var Xt=E((fs,zt)=>{var X=Object.defineProperty,an=Object.getOwnPropertyDescriptor,cn=Object.getOwnPropertyNames,fn=Object.prototype.hasOwnProperty,un=(e,t)=>X(e,"name",{value:t,configurable:!0}),ln=(e,t)=>{for(var s in t)X(e,s,{get:t[s],enumerable:!0})},hn=(e,t,s,c)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of cn(t))!fn.call(e,i)&&i!==s&&X(e,i,{get:()=>t[i],enumerable:!(c=an(t,i))||c.enumerable});return e},yn=e=>hn(X({},"__esModule",{value:!0}),e),Vt={};ln(Vt,{isArrayBuffer:()=>_n});zt.exports=yn(Vt);var _n=un(e=>typeof ArrayBuffer=="function"&&e instanceof ArrayBuffer||Object.prototype.toString.call(e)==="[object ArrayBuffer]","isArrayBuffer")});var Jt=E((us,Wt)=>{var Q=Object.defineProperty,dn=Object.getOwnPropertyDescriptor,pn=Object.getOwnPropertyNames,gn=Object.prototype.hasOwnProperty,Qt=(e,t)=>Q(e,"name",{value:t,configurable:!0}),mn=(e,t)=>{for(var s in t)Q(e,s,{get:t[s],enumerable:!0})},bn=(e,t,s,c)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of pn(t))!gn.call(e,i)&&i!==s&&Q(e,i,{get:()=>t[i],enumerable:!(c=dn(t,i))||c.enumerable});return e},En=e=>bn(Q({},"__esModule",{value:!0}),e),Zt={};mn(Zt,{fromArrayBuffer:()=>wn,fromString:()=>An});Wt.exports=En(Zt);var vn=Xt(),Ce=require("buffer"),wn=Qt((e,t=0,s=e.byteLength-t)=>{if(!(0,vn.isArrayBuffer)(e))throw new TypeError(`The "input" argument must be ArrayBuffer. Received type ${typeof e} (${e})`);return Ce.Buffer.from(e,t,s)},"fromArrayBuffer"),An=Qt((e,t)=>{if(typeof e!="string")throw new TypeError(`The "input" argument must be of type string. Received type ${typeof e} (${e})`);return t?Ce.Buffer.from(e,t):Ce.Buffer.from(e)},"fromString")});var sr=E((ls,nr)=>{var Z=Object.defineProperty,Sn=Object.getOwnPropertyDescriptor,Rn=Object.getOwnPropertyNames,On=Object.prototype.hasOwnProperty,Ie=(e,t)=>Z(e,"name",{value:t,configurable:!0}),Tn=(e,t)=>{for(var s in t)Z(e,s,{get:t[s],enumerable:!0})},Pn=(e,t,s,c)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of Rn(t))!On.call(e,i)&&i!==s&&Z(e,i,{get:()=>t[i],enumerable:!(c=Sn(t,i))||c.enumerable});return e},Hn=e=>Pn(Z({},"__esModule",{value:!0}),e),er={};Tn(er,{fromUtf8:()=>rr,toUint8Array:()=>Dn,toUtf8:()=>Un});nr.exports=Hn(er);var tr=Jt(),rr=Ie(e=>{let t=(0,tr.fromString)(e,"utf8");return new Uint8Array(t.buffer,t.byteOffset,t.byteLength/Uint8Array.BYTES_PER_ELEMENT)},"fromUtf8"),Dn=Ie(e=>typeof e=="string"?rr(e):ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(e),"toUint8Array"),Un=Ie(e=>{if(typeof e=="string")return e;if(typeof e!="object"||typeof e.byteOffset!="number"||typeof e.byteLength!="number")throw new Error("@smithy/util-utf8: toUtf8 encoder function only accepts string | Uint8Array.");return(0,tr.fromArrayBuffer)(e.buffer,e.byteOffset,e.byteLength).toString("utf8")},"toUtf8")});var or=E(W=>{"use strict";Object.defineProperty(W,"__esModule",{value:!0});W.convertToBuffer=void 0;var Cn=sr(),In=typeof Buffer<"u"&&Buffer.from?function(e){return Buffer.from(e,"utf8")}:Cn.fromUtf8;function xn(e){return e instanceof Uint8Array?e:typeof e=="string"?In(e):ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(e)}W.convertToBuffer=xn});var ar=E(J=>{"use strict";Object.defineProperty(J,"__esModule",{value:!0});J.isEmptyData=void 0;function jn(e){return typeof e=="string"?e.length===0:e.byteLength===0}J.isEmptyData=jn});var ir=E(ee=>{"use strict";Object.defineProperty(ee,"__esModule",{value:!0});ee.numToUint8=void 0;function Ln(e){return new Uint8Array([(e&4278190080)>>24,(e&16711680)>>16,(e&65280)>>8,e&255])}ee.numToUint8=Ln});var cr=E(te=>{"use strict";Object.defineProperty(te,"__esModule",{value:!0});te.uint32ArrayFrom=void 0;function Bn(e){if(!Uint32Array.from){for(var t=new Uint32Array(e.length),s=0;s<e.length;)t[s]=e[s],s+=1;return t}return Uint32Array.from(e)}te.uint32ArrayFrom=Bn});var fr=E(O=>{"use strict";Object.defineProperty(O,"__esModule",{value:!0});O.uint32ArrayFrom=O.numToUint8=O.isEmptyData=O.convertToBuffer=void 0;var Nn=or();Object.defineProperty(O,"convertToBuffer",{enumerable:!0,get:function(){return Nn.convertToBuffer}});var Mn=ar();Object.defineProperty(O,"isEmptyData",{enumerable:!0,get:function(){return Mn.isEmptyData}});var $n=ir();Object.defineProperty(O,"numToUint8",{enumerable:!0,get:function(){return $n.numToUint8}});var qn=cr();Object.defineProperty(O,"uint32ArrayFrom",{enumerable:!0,get:function(){return qn.uint32ArrayFrom}})});var lr=E(se=>{"use strict";Object.defineProperty(se,"__esModule",{value:!0});se.Sha256=void 0;var ur=De(),ne=Ue(),re=kt(),xe=fr(),Fn=function(){function e(t){this.secret=t,this.hash=new re.RawSha256,this.reset()}return e.prototype.update=function(t){if(!((0,xe.isEmptyData)(t)||this.error))try{this.hash.update((0,xe.convertToBuffer)(t))}catch(s){this.error=s}},e.prototype.digestSync=function(){if(this.error)throw this.error;return this.outer?(this.outer.finished||this.outer.update(this.hash.digest()),this.outer.digest()):this.hash.digest()},e.prototype.digest=function(){return ur.__awaiter(this,void 0,void 0,function(){return ur.__generator(this,function(t){return[2,this.digestSync()]})})},e.prototype.reset=function(){if(this.hash=new re.RawSha256,this.secret){this.outer=new re.RawSha256;var t=Kn(this.secret),s=new Uint8Array(ne.BLOCK_SIZE);s.set(t);for(var c=0;c<ne.BLOCK_SIZE;c++)t[c]^=54,s[c]^=92;this.hash.update(t),this.outer.update(s);for(var c=0;c<t.byteLength;c++)t[c]=0}},e}();se.Sha256=Fn;function Kn(e){var t=(0,xe.convertToBuffer)(e);if(t.byteLength>ne.BLOCK_SIZE){var s=new re.RawSha256;s.update(t),t=s.digest()}var c=new Uint8Array(ne.BLOCK_SIZE);return c.set(t),c}});var hr=E(je=>{"use strict";Object.defineProperty(je,"__esModule",{value:!0});var Gn=De();Gn.__exportStar(lr(),je)});var Xn={};Rr(Xn,{handler:()=>zn});module.exports=Or(Xn);var oe=require("@aws-sdk/client-secrets-manager"),_r=require("@aws-sdk/credential-provider-node"),dr=ae(le(),1),pr=ae(gt(),1),gr=ae(hr(),1),mr=require("timers/promises"),Yn=new oe.SecretsManager({}),br=async(e,t=0)=>{let{url:s,method:c,headers:i,body:r,successStatus:n}=e,o=await fetch(s,{method:c,headers:i,body:r}),a;try{let f=await o.text();console.log(`${o.status} ${f}`),a=JSON.parse(f)}catch(f){console.log(f)}if(o.status==403||o.status==401||a?.status==="CONFLICT"){if(t>10)throw new Error(`Request failed after ${t} retries.`);console.log(`Retrying #${t}... `);let f=t**2*500,u=Math.floor(Math.random()*f);return await(0,mr.setTimeout)(Math.min(f+u,1e4)),await br(e,t+1)}if(a===void 0)throw new Error("Response body is not a valid json.");if(!n.includes(a.status))throw new Error(`Request has an invalid status. Valid statuses: ${n.join(",")}`)},kn=(e,t)=>{let s=new Headers;return s.append("Authorization","Basic "+Buffer.from(e+":"+t).toString("base64")),s.append("Content-type","application/json"),s},Vn=async(e,t,s,c)=>{let i=new URL(t),r=new dr.HttpRequest({method:e,protocol:i.protocol,hostname:i.hostname,port:i.port?parseInt(i.port):void 0,path:i.pathname,query:Object.fromEntries(i.searchParams),headers:{host:i.hostname,"Content-Type":"application/json"},body:s}),o=await new pr.SignatureV4({service:"es",region:c,credentials:(0,_r.defaultProvider)(),sha256:gr.Sha256}).sign(r),a=new Headers;for(let[f,u]of Object.entries(o.headers))u!==void 0&&a.append(f,u);return a},zn=async(e,t)=>{console.log(JSON.stringify(e));let{ServiceToken:s,...c}=e.ResourceProperties,i=c;try{let r=`https://${i.opensearchHost}`,n=async(o,a,f,u)=>{let l=`${r}/${a}`,h;if(i.useSigV4Auth){if(!i.region)throw new Error("region is required when useSigV4Auth is enabled");h=await Vn(o,l,f,i.region)}else{if(!i.masterUserSecretArn)throw new Error("masterUserSecretArn is required when useSigV4Auth is not enabled");let d=await Yn.send(new oe.GetSecretValueCommand({SecretId:i.masterUserSecretArn})),{username:y,password:p}=JSON.parse(d.SecretString);h=kn(y,p)}await br({url:l,method:o,headers:h,body:f,successStatus:u})};switch(e.RequestType){case"Create":case"Update":{console.log(i.payloadJson),await n("PUT",i.restEndpoint,i.payloadJson,["OK","CREATED"]);break}case"Delete":{await n("DELETE",i.restEndpoint,void 0,["OK","NOT_FOUND"]);break}}await yr("SUCCESS",e,t,i)}catch(r){console.log(r),await yr("FAILED",e,t,i,r.message)}},yr=async(e,t,s,c,i)=>{let r=JSON.stringify({Status:e,Reason:(i??"")+" See the details in CloudWatch Log Stream: "+s.logStreamName,PhysicalResourceId:c.restEndpoint,StackId:t.StackId,RequestId:t.RequestId,LogicalResourceId:t.LogicalResourceId,NoEcho:!1,Data:{Empty:""}});await(await fetch(t.ResponseURL,{method:"PUT",body:r,headers:{"Content-Type":"","Content-Length":r.length.toString()}})).text()};0&&(module.exports={handler});
