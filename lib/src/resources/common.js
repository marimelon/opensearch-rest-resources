"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.recursiveFromCamelToSnake = void 0;
const camelToSnakeCase = (str) => str.replace(/[A-Z]/g, (c) => `_${c.toLowerCase()}`);
/**
 * Context: jsii requires property keys of an object to be camel-cased,
 * while OpenSearch uses snake case for a REST API request payload.
 *
 * This is a utility function to convert an object with camel-cased keys to snake-cased.
 *
 * @internal
 *
 * @param item The object whose keys will be transformed.
 * @param exclude The keys that will not be transformed and copied to output directly
 */
const recursiveFromCamelToSnake = (item, exclude = {}) => {
    // https://stackoverflow.com/a/75927783/18550269
    if (Array.isArray(item)) {
        // For arrays we just pass parent's exclude object directly
        // since it makes no sense to specify different exclude options for each array element
        return item.map((el) => (0, exports.recursiveFromCamelToSnake)(el, exclude));
    }
    else if (typeof item === 'function' || item !== Object(item)) {
        return item;
    }
    return Object.fromEntries(Object.entries(item).map(([key, value]) => {
        const childExclude = exclude[key];
        if (childExclude === true) {
            return [camelToSnakeCase(key), value];
        }
        else {
            return [camelToSnakeCase(key), (0, exports.recursiveFromCamelToSnake)(value, childExclude)];
        }
    }));
};
exports.recursiveFromCamelToSnake = recursiveFromCamelToSnake;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29tbW9uLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vc3JjL3Jlc291cmNlcy9jb21tb24udHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7O0FBa0NBLE1BQU0sZ0JBQWdCLEdBQUcsQ0FBQyxHQUFXLEVBQUUsRUFBRSxDQUFDLEdBQUcsQ0FBQyxPQUFPLENBQUMsUUFBUSxFQUFFLENBQUMsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxJQUFJLENBQUMsQ0FBQyxXQUFXLEVBQUUsRUFBRSxDQUFDLENBQUM7QUFJOUY7Ozs7Ozs7Ozs7R0FVRztBQUNJLE1BQU0seUJBQXlCLEdBQUcsQ0FBQyxJQUFhLEVBQUUsVUFBbUIsRUFBRSxFQUFXLEVBQUU7SUFDekYsZ0RBQWdEO0lBQ2hELElBQUksS0FBSyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDO1FBQ3hCLDJEQUEyRDtRQUMzRCxzRkFBc0Y7UUFDdEYsT0FBTyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsRUFBVyxFQUFFLEVBQUUsQ0FBQyxJQUFBLGlDQUF5QixFQUFDLEVBQUUsRUFBRSxPQUFPLENBQUMsQ0FBQyxDQUFDO0lBQzNFLENBQUM7U0FBTSxJQUFJLE9BQU8sSUFBSSxLQUFLLFVBQVUsSUFBSSxJQUFJLEtBQUssTUFBTSxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUM7UUFDL0QsT0FBTyxJQUFJLENBQUM7SUFDZCxDQUFDO0lBQ0QsT0FBTyxNQUFNLENBQUMsV0FBVyxDQUN2QixNQUFNLENBQUMsT0FBTyxDQUFDLElBQStCLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLEdBQUcsRUFBRSxLQUFLLENBQW9CLEVBQUUsRUFBRTtRQUN0RixNQUFNLFlBQVksR0FBRyxPQUFPLENBQUMsR0FBRyxDQUFDLENBQUM7UUFDbEMsSUFBSSxZQUFZLEtBQUssSUFBSSxFQUFFLENBQUM7WUFDMUIsT0FBTyxDQUFDLGdCQUFnQixDQUFDLEdBQUcsQ0FBQyxFQUFFLEtBQUssQ0FBQyxDQUFDO1FBQ3hDLENBQUM7YUFBTSxDQUFDO1lBQ04sT0FBTyxDQUFDLGdCQUFnQixDQUFDLEdBQUcsQ0FBQyxFQUFFLElBQUEsaUNBQXlCLEVBQUMsS0FBSyxFQUFFLFlBQVksQ0FBQyxDQUFDLENBQUM7UUFDakYsQ0FBQztJQUNILENBQUMsQ0FBQyxDQUNILENBQUM7QUFDSixDQUFDLENBQUM7QUFuQlcsUUFBQSx5QkFBeUIsNkJBbUJwQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFJlbW92YWxQb2xpY3kgfSBmcm9tICdhd3MtY2RrLWxpYic7XG5pbXBvcnQgeyBJVnBjIH0gZnJvbSAnYXdzLWNkay1saWIvYXdzLWVjMic7XG5pbXBvcnQgeyBEb21haW4gfSBmcm9tICdhd3MtY2RrLWxpYi9hd3Mtb3BlbnNlYXJjaHNlcnZpY2UnO1xuXG5leHBvcnQgaW50ZXJmYWNlIFJlc291cmNlUHJvcHNCYXNlIHtcbiAgLyoqXG4gICAqIFRoZSBWUEMgeW91ciBPcGVuU2VhcmNoIGRvbWFpbiBpcyBpbi5cbiAgICpcbiAgICogQGRlZmF1bHQgQXNzdW1lcyB5b3VyIERvbWFpbiBpcyBub3QgZGVwbG95ZWQgd2l0aGluIGEgVlBDXG4gICAqL1xuICByZWFkb25seSB2cGM/OiBJVnBjO1xuXG4gIC8qKlxuICAgKiBUaGUgT3BlblNlYXJjaCBkb21haW4geW91IHdhbnQgdG8gY3JlYXRlIGEgcmVzb3VyY2UgaW4uXG4gICAqL1xuICByZWFkb25seSBkb21haW46IERvbWFpbjtcblxuICAvKipcbiAgICogUG9saWN5IHRvIGFwcGx5IHdoZW4gdGhlIHJlc291cmNlIGlzIHJlbW92ZWQgZnJvbSB0aGUgc3RhY2tcbiAgICpcbiAgICogQGRlZmF1bHQgUmVtb3ZhbFBvbGljeS5ERVNUUk9ZXG4gICAqL1xuICByZWFkb25seSByZW1vdmFsUG9saWN5PzogUmVtb3ZhbFBvbGljeTtcblxuICAvKipcbiAgICogV2hldGhlciB0byB1c2UgQVdTIFNpZ1Y0IGF1dGhlbnRpY2F0aW9uIGluc3RlYWQgb2YgSFRUUCBCYXNpYyBBdXRoLlxuICAgKiBXaGVuIGVuYWJsZWQsIHRoZSBMYW1iZGEgZnVuY3Rpb24ncyBJQU0gcm9sZSBpcyB1c2VkIGZvciBhdXRoZW50aWNhdGlvbixcbiAgICogYW5kIG1hc3RlciB1c2VyIHNlY3JldCBpcyBub3QgcmVxdWlyZWQuXG4gICAqXG4gICAqIEBkZWZhdWx0IGZhbHNlXG4gICAqL1xuICByZWFkb25seSB1c2VTaWdWNEF1dGg/OiBib29sZWFuO1xufVxuXG5jb25zdCBjYW1lbFRvU25ha2VDYXNlID0gKHN0cjogc3RyaW5nKSA9PiBzdHIucmVwbGFjZSgvW0EtWl0vZywgKGMpID0+IGBfJHtjLnRvTG93ZXJDYXNlKCl9YCk7XG5cbnR5cGUgRXhjbHVkZSA9IHsgW2tleTogc3RyaW5nXTogRXhjbHVkZSB8IHRydWUgfTtcblxuLyoqXG4gKiBDb250ZXh0OiBqc2lpIHJlcXVpcmVzIHByb3BlcnR5IGtleXMgb2YgYW4gb2JqZWN0IHRvIGJlIGNhbWVsLWNhc2VkLFxuICogd2hpbGUgT3BlblNlYXJjaCB1c2VzIHNuYWtlIGNhc2UgZm9yIGEgUkVTVCBBUEkgcmVxdWVzdCBwYXlsb2FkLlxuICpcbiAqIFRoaXMgaXMgYSB1dGlsaXR5IGZ1bmN0aW9uIHRvIGNvbnZlcnQgYW4gb2JqZWN0IHdpdGggY2FtZWwtY2FzZWQga2V5cyB0byBzbmFrZS1jYXNlZC5cbiAqXG4gKiBAaW50ZXJuYWxcbiAqXG4gKiBAcGFyYW0gaXRlbSBUaGUgb2JqZWN0IHdob3NlIGtleXMgd2lsbCBiZSB0cmFuc2Zvcm1lZC5cbiAqIEBwYXJhbSBleGNsdWRlIFRoZSBrZXlzIHRoYXQgd2lsbCBub3QgYmUgdHJhbnNmb3JtZWQgYW5kIGNvcGllZCB0byBvdXRwdXQgZGlyZWN0bHlcbiAqL1xuZXhwb3J0IGNvbnN0IHJlY3Vyc2l2ZUZyb21DYW1lbFRvU25ha2UgPSAoaXRlbTogdW5rbm93biwgZXhjbHVkZTogRXhjbHVkZSA9IHt9KTogdW5rbm93biA9PiB7XG4gIC8vIGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vYS83NTkyNzc4My8xODU1MDI2OVxuICBpZiAoQXJyYXkuaXNBcnJheShpdGVtKSkge1xuICAgIC8vIEZvciBhcnJheXMgd2UganVzdCBwYXNzIHBhcmVudCdzIGV4Y2x1ZGUgb2JqZWN0IGRpcmVjdGx5XG4gICAgLy8gc2luY2UgaXQgbWFrZXMgbm8gc2Vuc2UgdG8gc3BlY2lmeSBkaWZmZXJlbnQgZXhjbHVkZSBvcHRpb25zIGZvciBlYWNoIGFycmF5IGVsZW1lbnRcbiAgICByZXR1cm4gaXRlbS5tYXAoKGVsOiB1bmtub3duKSA9PiByZWN1cnNpdmVGcm9tQ2FtZWxUb1NuYWtlKGVsLCBleGNsdWRlKSk7XG4gIH0gZWxzZSBpZiAodHlwZW9mIGl0ZW0gPT09ICdmdW5jdGlvbicgfHwgaXRlbSAhPT0gT2JqZWN0KGl0ZW0pKSB7XG4gICAgcmV0dXJuIGl0ZW07XG4gIH1cbiAgcmV0dXJuIE9iamVjdC5mcm9tRW50cmllcyhcbiAgICBPYmplY3QuZW50cmllcyhpdGVtIGFzIFJlY29yZDxzdHJpbmcsIHVua25vd24+KS5tYXAoKFtrZXksIHZhbHVlXTogW3N0cmluZywgdW5rbm93bl0pID0+IHtcbiAgICAgIGNvbnN0IGNoaWxkRXhjbHVkZSA9IGV4Y2x1ZGVba2V5XTtcbiAgICAgIGlmIChjaGlsZEV4Y2x1ZGUgPT09IHRydWUpIHtcbiAgICAgICAgcmV0dXJuIFtjYW1lbFRvU25ha2VDYXNlKGtleSksIHZhbHVlXTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBbY2FtZWxUb1NuYWtlQ2FzZShrZXkpLCByZWN1cnNpdmVGcm9tQ2FtZWxUb1NuYWtlKHZhbHVlLCBjaGlsZEV4Y2x1ZGUpXTtcbiAgICAgIH1cbiAgICB9KSxcbiAgKTtcbn07XG4iXX0=